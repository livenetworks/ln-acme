(function(){"use strict";(function(){const m="data-ln-ajax",c="lnAjax";if(window[c]!==void 0)return;function p(e,n,d){e.dispatchEvent(new CustomEvent(n,{bubbles:!0,detail:d||{}}))}function b(e){if(!e.hasAttribute(m)||e[c])return;e[c]=!0;const n=s(e);y(n.links),E(n.forms)}function y(e){e.forEach(function(n){if(n._lnAjaxAttached)return;const d=n.getAttribute("href");d&&d.includes("#")||(n._lnAjaxAttached=!0,n.addEventListener("click",function(t){if(t.ctrlKey||t.metaKey||t.button===1)return;t.preventDefault();const i=n.getAttribute("href");i&&f("GET",i,null,n)}))})}function E(e){e.forEach(function(n){n._lnAjaxAttached||(n._lnAjaxAttached=!0,n.addEventListener("submit",function(d){d.preventDefault();const t=n.method.toUpperCase(),i=n.action,a=new FormData(n);n.querySelectorAll('button, input[type="submit"]').forEach(function(l){l.disabled=!0}),f(t,i,a,n,function(){n.querySelectorAll('button, input[type="submit"]').forEach(function(l){l.disabled=!1})})}))})}function f(e,n,d,t,i){p(t,"ln-ajax:start",{method:e,url:n}),t.classList.add("ln-ajax--loading");const a=document.createElement("span");a.className="ln-ajax-spinner",t.appendChild(a);function l(){t.classList.remove("ln-ajax--loading");const g=t.querySelector(".ln-ajax-spinner");g&&g.remove(),i&&i()}let h=n;const v=document.querySelector('meta[name="csrf-token"]'),_=v?v.getAttribute("content"):null;d instanceof FormData&&_&&d.append("_token",_);const T={method:e,headers:{"X-Requested-With":"XMLHttpRequest",Accept:"application/json"}};if(_&&(T.headers["X-CSRF-TOKEN"]=_),e==="GET"&&d){const g=new URLSearchParams(d);h=n+(n.includes("?")?"&":"?")+g.toString()}else e!=="GET"&&d&&(T.body=d);fetch(h,T).then(g=>g.json()).then(g=>{if(g.title&&(document.title=g.title),g.content)for(let A in g.content){const C=document.getElementById(A);C&&(C.innerHTML=g.content[A])}if(t.tagName==="A"){const A=t.getAttribute("href");A&&window.history.pushState({ajax:!0},"",A)}else t.tagName==="FORM"&&t.method.toUpperCase()==="GET"&&window.history.pushState({ajax:!0},"",h);p(t,"ln-ajax:success",{method:e,url:h,data:g}),p(t,"ln-ajax:complete",{method:e,url:h}),l()}).catch(g=>{p(t,"ln-ajax:error",{method:e,url:h,error:g}),p(t,"ln-ajax:complete",{method:e,url:h}),l()})}function s(e){const n={links:[],forms:[]};return e.tagName==="A"&&e.getAttribute(m)!=="false"?n.links.push(e):e.tagName==="FORM"&&e.getAttribute(m)!=="false"?n.forms.push(e):(n.links=Array.from(e.querySelectorAll('a:not([data-ln-ajax="false"])')),n.forms=Array.from(e.querySelectorAll('form:not([data-ln-ajax="false"])'))),n}function r(){new MutationObserver(function(n){n.forEach(function(d){d.type==="childList"&&d.addedNodes.forEach(function(t){t.nodeType===1&&(b(t),t.hasAttribute(m)||t.querySelectorAll("["+m+"]").forEach(function(i){b(i)}))})})}).observe(document.body,{childList:!0,subtree:!0})}function o(){document.querySelectorAll("["+m+"]").forEach(function(e){b(e)})}window[c]=b,r(),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",o):o()})(),(function(){const m="data-ln-modal",c="lnModal";if(window[c]!==void 0)return;function p(e,n){e.dispatchEvent(new CustomEvent(n,{bubbles:!0,detail:{modalId:e.id}}))}function b(e){const n=document.getElementById(e);if(!n){console.warn('Modal with ID "'+e+'" not found');return}n.classList.add("ln-modal--open"),document.body.classList.add("ln-modal-open"),p(n,"ln-modal:open")}function y(e){const n=document.getElementById(e);n&&(n.classList.remove("ln-modal--open"),p(n,"ln-modal:close"),document.querySelector(".ln-modal.ln-modal--open")||document.body.classList.remove("ln-modal-open"))}function E(e){const n=document.getElementById(e);if(!n){console.warn('Modal with ID "'+e+'" not found');return}n.classList.contains("ln-modal--open")?y(e):b(e)}function f(e){const n=e.querySelectorAll("[data-ln-modal-close]"),d=e.id;n.forEach(function(t){t._lnModalCloseAttached||(t._lnModalCloseAttached=!0,t.addEventListener("click",function(i){i.preventDefault(),y(d)}))})}function s(e){e.forEach(function(n){n._lnModalAttached||(n._lnModalAttached=!0,n.addEventListener("click",function(d){if(d.ctrlKey||d.metaKey||d.button===1)return;d.preventDefault();const t=n.getAttribute(m);t&&E(t)}))})}function r(){const e=document.querySelectorAll("["+m+"]");s(e),document.querySelectorAll(".ln-modal").forEach(function(d){f(d)}),document.addEventListener("keydown",function(d){d.key==="Escape"&&document.querySelectorAll(".ln-modal.ln-modal--open").forEach(function(i){y(i.id)})})}function o(){new MutationObserver(function(n){n.forEach(function(d){d.type==="childList"&&d.addedNodes.forEach(function(t){if(t.nodeType===1){t.hasAttribute(m)&&s([t]);const i=t.querySelectorAll("["+m+"]");i.length>0&&s(i),t.id&&t.classList.contains("ln-modal")&&f(t);const a=t.querySelectorAll(".ln-modal");a.length>0&&a.forEach(function(l){f(l)})}})})}).observe(document.body,{childList:!0,subtree:!0})}window[c]={open:b,close:y,toggle:E},o(),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",r):r()})(),(function(){const m="data-ln-nav",c="lnNav";if(window[c]!==void 0)return;const p=new WeakMap;function b(r){if(!r.hasAttribute(m)||p.has(r))return;const o=r.getAttribute(m);if(!o)return;const e=y(r,o);p.set(r,e)}function y(r,o){let e=Array.from(r.querySelectorAll("a"));f(e,o,window.location.pathname);const n=function(){e=Array.from(r.querySelectorAll("a")),f(e,o,window.location.pathname)};window.addEventListener("popstate",n);const d=history.pushState;history.pushState=function(){d.apply(history,arguments),e=Array.from(r.querySelectorAll("a")),f(e,o,window.location.pathname)};const t=new MutationObserver(function(i){i.forEach(function(a){a.type==="childList"&&(a.addedNodes.forEach(function(l){if(l.nodeType===1){if(l.tagName==="A")e.push(l),f([l],o,window.location.pathname);else if(l.querySelectorAll){const h=Array.from(l.querySelectorAll("a"));e=e.concat(h),f(h,o,window.location.pathname)}}}),a.removedNodes.forEach(function(l){if(l.nodeType===1){if(l.tagName==="A")e=e.filter(function(h){return h!==l});else if(l.querySelectorAll){const h=Array.from(l.querySelectorAll("a"));e=e.filter(function(v){return!h.includes(v)})}}}))})});return t.observe(r,{childList:!0,subtree:!0}),{navElement:r,activeClass:o,observer:t}}function E(r){try{return new URL(r,window.location.href).pathname.replace(/\/$/,"")||"/"}catch{return r.replace(/\/$/,"")||"/"}}function f(r,o,e){const n=E(e);r.forEach(function(d){const t=d.getAttribute("href");if(!t)return;const i=E(t);d.classList.remove(o);const a=i===n,l=i!=="/"&&n.startsWith(i+"/");(a||l)&&d.classList.add(o)})}window[c]=b;function s(){document.querySelectorAll("["+m+"]").forEach(function(o){b(o)})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",s):s()})(),(function(){const m=window.TomSelect;if(!m){window.lnSelect={initialize:function(){},destroy:function(){},getInstance:function(){return null}};return}const c=new WeakMap;function p(f){if(c.has(f))return;const s=f.getAttribute("data-ln-select");let r={};if(s&&s.trim()!=="")try{r=JSON.parse(s)}catch(n){console.warn("Invalid JSON in data-ln-select attribute:",n)}const e={...{allowEmptyOption:!0,controlInput:null,create:!1,highlight:!0,closeAfterSelect:!0,placeholder:f.getAttribute("placeholder")||"Select...",loadThrottle:300},...r};try{const n=new m(f,e);c.set(f,n);const d=f.closest("form");d&&d.addEventListener("reset",()=>{setTimeout(()=>{n.clear(),n.clearOptions(),n.sync()},0)})}catch(n){console.error("Failed to initialize Tom Select:",n)}}function b(f){const s=c.get(f);s&&(s.destroy(),c.delete(f))}function y(){document.querySelectorAll("select[data-ln-select]").forEach(p)}function E(){new MutationObserver(s=>{s.forEach(r=>{r.addedNodes.forEach(o=>{o.nodeType===1&&(o.matches&&o.matches("select[data-ln-select]")&&p(o),o.querySelectorAll&&o.querySelectorAll("select[data-ln-select]").forEach(p))}),r.removedNodes.forEach(o=>{o.nodeType===1&&(o.matches&&o.matches("select[data-ln-select]")&&b(o),o.querySelectorAll&&o.querySelectorAll("select[data-ln-select]").forEach(b))})})}).observe(document.body,{childList:!0,subtree:!0})}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{y(),E()}):(y(),E()),window.lnSelect={initialize:p,destroy:b,getInstance:f=>c.get(f)}})(),(function(){const m="data-ln-tabs",c="lnTabs";if(window[c]!==void 0&&window[c]!==null)return;function p(s=document.body){b(s)}function b(s){if(s.nodeType!==1)return;let r=Array.from(s.querySelectorAll("["+m+"]"));s.hasAttribute&&s.hasAttribute(m)&&r.push(s),r.forEach(function(o){o[c]||(o[c]=new y(o))})}function y(s){return this.dom=s,E.call(this),this}function E(){this.tabs=Array.from(this.dom.querySelectorAll("[data-ln-tab]")),this.panels=Array.from(this.dom.querySelectorAll("[data-ln-panel]")),this.mapTabs={},this.mapPanels={};for(const s of this.tabs){const r=(s.getAttribute("data-ln-tab")||"").toLowerCase().trim();r&&(this.mapTabs[r]=s)}for(const s of this.panels){const r=(s.getAttribute("data-ln-panel")||"").toLowerCase().trim();r&&(this.mapPanels[r]=s)}this.defaultKey=(this.dom.getAttribute("data-ln-tabs-default")||"").toLowerCase().trim()||Object.keys(this.mapTabs)[0]||"",this.autoFocus=(this.dom.getAttribute("data-ln-tabs-focus")||"true").toLowerCase()!=="false",this.tabs.forEach(s=>{s.addEventListener("click",()=>{const r=(s.getAttribute("data-ln-tab")||"").toLowerCase().trim();r&&(location.hash==="#"+r?this.activate(r):location.hash=r)})}),this._hashHandler=()=>{const s=(location.hash||"").replace("#","").toLowerCase();this.activate(s||this.defaultKey)},window.addEventListener("hashchange",this._hashHandler),this._hashHandler()}y.prototype.activate=function(s){var r;(!s||!(s in this.mapPanels))&&(s=this.defaultKey);for(const o in this.mapTabs){const e=this.mapTabs[o];o===s?(e.setAttribute("data-active",""),e.setAttribute("aria-selected","true")):(e.removeAttribute("data-active"),e.setAttribute("aria-selected","false"))}for(const o in this.mapPanels){const e=this.mapPanels[o],n=o===s;e.classList.toggle("hidden",!n),e.setAttribute("aria-hidden",n?"false":"true")}if(this.autoFocus){const o=(r=this.mapPanels[s])==null?void 0:r.querySelector('input,button,select,textarea,[tabindex]:not([tabindex="-1"])');o&&setTimeout(()=>o.focus({preventScroll:!0}),0)}};function f(){new MutationObserver(function(r){r.forEach(function(o){o.addedNodes.forEach(function(e){b(e)})})}).observe(document.body,{childList:!0,subtree:!0})}f(),window[c]=p,p(document.body)})(),(function(){const m="data-ln-toggle",c="lnToggle";if(window[c]!==void 0)return;function p(r){b(r),y(r)}function b(r){var o=r.querySelectorAll("["+m+"]")||[];r.hasAttribute&&r.hasAttribute(m)&&(o=Array.from(o),o.push(r)),o.forEach(function(e){e[c]||(e[c]=new E(e))})}function y(r){var o=r.querySelectorAll("[data-ln-toggle-for]")||[];r.hasAttribute&&r.hasAttribute("data-ln-toggle-for")&&(o=Array.from(o),o.push(r)),o.forEach(function(e){e.addEventListener("click",function(n){n.preventDefault();var d=e.getAttribute("data-ln-toggle-for"),t=document.getElementById(d);if(!(!t||!t[c])){var i=e.getAttribute("data-ln-toggle-action")||"toggle";t[c][i]()}})})}function E(r){return this.dom=r,this.isOpen=r.getAttribute(m)==="open",this.isOpen&&r.classList.add("open"),this}E.prototype.open=function(){this.isOpen||(this.isOpen=!0,this.dom.classList.add("open"),f(this.dom,"ln-toggle:open",{target:this.dom}))},E.prototype.close=function(){this.isOpen&&(this.isOpen=!1,this.dom.classList.remove("open"),f(this.dom,"ln-toggle:close",{target:this.dom}))},E.prototype.toggle=function(){this.isOpen?this.close():this.open()};function f(r,o,e){r.dispatchEvent(new CustomEvent(o,{bubbles:!0,detail:e||{}}))}function s(){var r=new MutationObserver(function(o){o.forEach(function(e){e.type==="childList"&&e.addedNodes.forEach(function(n){n.nodeType===1&&(b(n),y(n))})})});r.observe(document.body,{childList:!0,subtree:!0})}window[c]=p,s(),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){p(document.body)}):p(document.body)})(),(function(){const m="data-ln-accordion",c="lnAccordion";if(window[c]!==void 0)return;function p(f){b(f)}function b(f){var s=f.querySelectorAll("["+m+"]")||[];f.hasAttribute&&f.hasAttribute(m)&&(s=Array.from(s),s.push(f)),s.forEach(function(r){r[c]||(r[c]=new y(r))})}function y(f){return this.dom=f,f.addEventListener("ln-toggle:open",function(s){var r=f.querySelectorAll("[data-ln-toggle]");r.forEach(function(o){o!==s.detail.target&&o.lnToggle&&o.lnToggle.isOpen&&o.lnToggle.close()})}),this}function E(){var f=new MutationObserver(function(s){s.forEach(function(r){r.type==="childList"&&r.addedNodes.forEach(function(o){o.nodeType===1&&b(o)})})});f.observe(document.body,{childList:!0,subtree:!0})}window[c]=p,E(),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){p(document.body)}):p(document.body)})(),(function(){const m="data-ln-toast",c="lnToast",p={success:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m5 12 5 5L20 7"/></svg>',error:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>',warn:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 1.67 10.42 18.04H1.58L12 1.67z"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>',info:'<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>'};if(window[c]!==void 0&&window[c]!==null)return;function b(t=document.body){return y(t),n}function y(t){if(!t||t.nodeType!==1)return;let i=Array.from(t.querySelectorAll("["+m+"]"));t.hasAttribute&&t.hasAttribute(m)&&i.push(t),i.forEach(a=>{a[c]||new E(a)})}function E(t){return this.dom=t,t[c]=this,this.timeoutDefault=parseInt(t.getAttribute("data-ln-toast-timeout")||"6000",10),this.max=parseInt(t.getAttribute("data-ln-toast-max")||"5",10),Array.from(t.querySelectorAll("[data-ln-toast-item]")).forEach(i=>{f(i)}),this}function f(t){const i=((t.getAttribute("data-type")||"info")+"").toLowerCase(),a=t.getAttribute("data-title"),l=(t.innerText||t.textContent||"").trim();t.className="ln-toast__item",t.removeAttribute("data-ln-toast-item");const h=document.createElement("div");h.className="ln-toast__card ln-toast__card--"+i,h.setAttribute("role",i==="error"?"alert":"status"),h.setAttribute("aria-live",i==="error"?"assertive":"polite");const v=document.createElement("div");v.className="ln-toast__side",v.innerHTML=p[i]||p.info;const _=document.createElement("div");_.className="ln-toast__content";const T=document.createElement("div");T.className="ln-toast__head";const g=document.createElement("strong");g.className="ln-toast__title",g.textContent=a||(i==="success"?"Success":i==="error"?"Error":i==="warn"?"Warning":"Information");const A=document.createElement("button");if(A.type="button",A.className="ln-toast__close",A.setAttribute("aria-label","Close"),A.innerHTML="&times;",A.addEventListener("click",()=>r(t)),T.appendChild(g),_.appendChild(T),_.appendChild(A),l){const C=document.createElement("div");C.className="ln-toast__body";const O=document.createElement("p");O.textContent=l,C.appendChild(O),_.appendChild(C)}h.appendChild(v),h.appendChild(_),t.innerHTML="",t.appendChild(h),requestAnimationFrame(()=>t.classList.add("ln-toast__item--in"))}function s(t,i){for(;t.dom.children.length>=t.max;)t.dom.removeChild(t.dom.firstElementChild);t.dom.appendChild(i),requestAnimationFrame(()=>i.classList.add("ln-toast__item--in"))}function r(t){!t||!t.parentNode||(clearTimeout(t._timer),t.classList.remove("ln-toast__item--in"),t.classList.add("ln-toast__item--out"),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t)},200))}function o(t={}){let i=t.container;if(typeof i=="string"&&(i=document.querySelector(i)),i instanceof HTMLElement||(i=document.querySelector("["+m+"]")||document.getElementById("ln-toast-container")),!i)return null;const a=i[c]||new E(i),l=Number.isFinite(t.timeout)?t.timeout:a.timeoutDefault,h=(t.type||"info").toLowerCase(),v=document.createElement("li");v.className="ln-toast__item";const _=document.createElement("div");_.className="ln-toast__card ln-toast__card--"+h,_.setAttribute("role",h==="error"?"alert":"status"),_.setAttribute("aria-live",h==="error"?"assertive":"polite");const T=document.createElement("div");T.className="ln-toast__side",T.innerHTML=p[h]||p.info;const g=document.createElement("div");g.className="ln-toast__content";const A=document.createElement("div");A.className="ln-toast__head";const C=document.createElement("strong");C.className="ln-toast__title",C.textContent=t.title||(h==="success"?"Success":h==="error"?"Error":h==="warn"?"Warning":"Information");const O=document.createElement("button");if(O.type="button",O.className="ln-toast__close",O.setAttribute("aria-label","Close"),O.innerHTML="&times;",O.addEventListener("click",()=>r(v)),A.appendChild(C),g.appendChild(A),g.appendChild(O),t.message||t.data&&t.data.errors){const x=document.createElement("div");if(x.className="ln-toast__body",t.message)if(Array.isArray(t.message)){const M=document.createElement("ul");t.message.forEach(function(D){const u=document.createElement("li");u.textContent=D,M.appendChild(u)}),x.appendChild(M)}else{const M=document.createElement("p");M.textContent=t.message,M.style.margin="0",x.appendChild(M)}if(t.data&&t.data.errors){const M=document.createElement("ul");Object.values(t.data.errors).flat().forEach(D=>{const u=document.createElement("li");u.textContent=D,M.appendChild(u)}),x.appendChild(M)}g.appendChild(x)}return _.appendChild(T),_.appendChild(g),v.appendChild(_),s(a,v),l>0&&(v._timer=setTimeout(()=>r(v),l)),v}function e(t){let i=t;typeof i=="string"&&(i=document.querySelector(i)),i instanceof HTMLElement||(i=document.querySelector("["+m+"]")||document.getElementById("ln-toast-container")),i&&Array.from(i.children).forEach(r)}const n=function(t){return b(t)};n.enqueue=o,n.clear=e,new MutationObserver(t=>{t.forEach(i=>i.addedNodes.forEach(a=>y(a)))}).observe(document.body,{childList:!0,subtree:!0}),window[c]=n,window.addEventListener("ln-toast:enqueue",function(t){t.detail&&n.enqueue(t.detail)}),b(document.body)})(),(function(){const m="data-ln-upload",c="lnUpload",p="data-ln-upload-dict",b="data-ln-upload-accept",y="data-ln-upload-context";if(window[c]!==void 0)return;function E(i,a){const l=i.querySelector("["+p+'="'+a+'"]');return l?l.textContent:a}function f(i){if(i===0)return"0 B";const a=1024,l=["B","KB","MB","GB"],h=Math.floor(Math.log(i)/Math.log(a));return parseFloat((i/Math.pow(a,h)).toFixed(1))+" "+l[h]}function s(i){return i.split(".").pop().toLowerCase()}function r(i){return i==="docx"&&(i="doc"),["pdf","doc","epub"].includes(i)?"ln-icon-file-"+i:"ln-icon-file"}function o(i,a){if(!a)return!0;const l="."+s(i.name);return a.split(",").map(function(v){return v.trim().toLowerCase()}).includes(l.toLowerCase())}function e(i,a,l){i.dispatchEvent(new CustomEvent(a,{bubbles:!0,detail:l}))}function n(i){if(i.hasAttribute("data-ln-upload-initialized"))return;i.setAttribute("data-ln-upload-initialized","true");const a=i.querySelector(".ln-upload__zone"),l=i.querySelector(".ln-upload__list"),h=i.getAttribute(b)||"";let v=i.querySelector('input[type="file"]');v||(v=document.createElement("input"),v.type="file",v.multiple=!0,v.style.display="none",h&&(v.accept=h.split(",").map(function(u){return u=u.trim(),u.startsWith(".")?u:"."+u}).join(",")),i.appendChild(v));const _=i.getAttribute(m)||"/files/upload",T=i.getAttribute(y)||"",g=new Map;let A=0;function C(){const u=document.querySelector('meta[name="csrf-token"]');return u?u.getAttribute("content"):""}function O(u){if(!o(u,h)){const L=E(i,"invalid-type");e(i,"ln-upload:invalid",{file:u,message:L}),window.dispatchEvent(new CustomEvent("ln-toast:enqueue",{detail:{type:"error",title:"Invalid File",message:L||"This file type is not allowed"}}));return}const w="file-"+ ++A,S=s(u.name),B=r(S),k=document.createElement("li");k.className="ln-upload__item ln-upload__item--uploading "+B,k.setAttribute("data-file-id",w);const F=document.createElement("span");F.className="ln-upload__name",F.textContent=u.name;const I=document.createElement("span");I.className="ln-upload__size",I.textContent="0%";const N=document.createElement("button");N.type="button",N.className="ln-upload__remove",N.title=E(i,"remove"),N.textContent="Ã—",N.disabled=!0;const R=document.createElement("div");R.className="ln-upload__progress";const z=document.createElement("div");z.className="ln-upload__progress-bar",R.appendChild(z),k.appendChild(F),k.appendChild(I),k.appendChild(N),k.appendChild(R),l.appendChild(k);const U=new FormData;U.append("file",u),U.append("context",T);const q=new XMLHttpRequest;q.upload.addEventListener("progress",function(L){if(L.lengthComputable){const j=Math.round(L.loaded/L.total*100);z.style.width=j+"%",I.textContent=j+"%"}}),q.addEventListener("load",function(){if(q.status>=200&&q.status<300){var L;try{L=JSON.parse(q.responseText)}catch{H("Invalid response");return}k.classList.remove("ln-upload__item--uploading"),I.textContent=f(L.size||u.size),N.disabled=!1,g.set(w,{serverId:L.id,name:L.name,size:L.size}),x(),e(i,"ln-upload:uploaded",{localId:w,serverId:L.id,name:L.name})}else{var j="Upload failed";try{var P=JSON.parse(q.responseText);j=P.message||j}catch{}H(j)}}),q.addEventListener("error",function(){H("Network error")});function H(L){k.classList.remove("ln-upload__item--uploading"),k.classList.add("ln-upload__item--error"),z.style.width="100%",I.textContent=E(i,"error"),N.disabled=!1,e(i,"ln-upload:error",{file:u,message:L}),window.dispatchEvent(new CustomEvent("ln-toast:enqueue",{detail:{type:"error",title:"Upload Error",message:L||E(i,"upload-failed")||"Failed to upload file"}}))}q.open("POST",_),q.setRequestHeader("X-CSRF-TOKEN",C()),q.setRequestHeader("Accept","application/json"),q.send(U)}function x(){i.querySelectorAll('input[name="file_ids[]"]').forEach(function(u){u.remove()}),g.forEach(function(u){const w=document.createElement("input");w.type="hidden",w.name="file_ids[]",w.value=u.serverId,i.appendChild(w)})}function M(u){const w=g.get(u),S=l.querySelector('[data-file-id="'+u+'"]');if(!w||!w.serverId){S&&S.remove(),g.delete(u),x();return}S&&S.classList.add("ln-upload__item--deleting"),fetch("/files/"+w.serverId,{method:"DELETE",headers:{"X-CSRF-TOKEN":C(),Accept:"application/json"}}).then(B=>{B.status===200?(S&&S.remove(),g.delete(u),x(),e(i,"ln-upload:removed",{localId:u,serverId:w.serverId})):(S&&S.classList.remove("ln-upload__item--deleting"),window.dispatchEvent(new CustomEvent("ln-toast:enqueue",{detail:{type:"error",title:"Error",message:E(i,"delete-error")||"Failed to delete file"}})))}).catch(B=>{console.error("Delete error:",B),S&&S.classList.remove("ln-upload__item--deleting"),window.dispatchEvent(new CustomEvent("ln-toast:enqueue",{detail:{type:"error",title:"Network Error",message:"Could not connect to server"}}))})}function D(u){Array.from(u).forEach(function(w){O(w)}),v.value=""}a.addEventListener("click",function(){v.click()}),v.addEventListener("change",function(){D(this.files)}),a.addEventListener("dragenter",function(u){u.preventDefault(),u.stopPropagation(),a.classList.add("ln-upload__zone--dragover")}),a.addEventListener("dragover",function(u){u.preventDefault(),u.stopPropagation(),a.classList.add("ln-upload__zone--dragover")}),a.addEventListener("dragleave",function(u){u.preventDefault(),u.stopPropagation(),a.classList.remove("ln-upload__zone--dragover")}),a.addEventListener("drop",function(u){u.preventDefault(),u.stopPropagation(),a.classList.remove("ln-upload__zone--dragover"),D(u.dataTransfer.files)}),l.addEventListener("click",function(u){if(u.target.classList.contains("ln-upload__remove")){const w=u.target.closest(".ln-upload__item");w&&M(w.getAttribute("data-file-id"))}}),i.lnUploadAPI={getFileIds:function(){return Array.from(g.values()).map(function(u){return u.serverId})},getFiles:function(){return Array.from(g.values())},clear:function(){g.forEach(function(u){u.serverId&&fetch("/files/"+u.serverId,{method:"DELETE",headers:{"X-CSRF-TOKEN":C(),Accept:"application/json"}})}),g.clear(),l.innerHTML="",x(),e(i,"ln-upload:cleared",{})}}}function d(){document.querySelectorAll("["+m+"]").forEach(n)}function t(){new MutationObserver(function(a){a.forEach(function(l){l.type==="childList"&&l.addedNodes.forEach(function(h){h.nodeType===1&&(h.hasAttribute(m)&&n(h),h.querySelectorAll("["+m+"]").forEach(n))})})}).observe(document.body,{childList:!0,subtree:!0})}window[c]={init:n,initAll:d},t(),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",d):d()})(),(function(){const m="lnExternalLinks";if(window[m]!==void 0)return;function c(r,o,e){r.dispatchEvent(new CustomEvent(o,{bubbles:!0,detail:e}))}function p(r){return r.hostname&&r.hostname!==window.location.hostname}function b(r){r.getAttribute("data-ln-external-link")!=="processed"&&p(r)&&(r.target="_blank",r.rel="noopener noreferrer",r.setAttribute("data-ln-external-link","processed"),c(r,"ln-external-links:processed",{link:r,href:r.href}))}function y(r){r=r||document.body,r.querySelectorAll("a, area").forEach(function(e){b(e)})}function E(){document.body.addEventListener("click",function(r){const o=r.target.closest("a, area");o&&o.getAttribute("data-ln-external-link")==="processed"&&c(o,"ln-external-links:clicked",{link:o,href:o.href,text:o.textContent||o.title||""})})}function f(){new MutationObserver(function(o){o.forEach(function(e){e.type==="childList"&&e.addedNodes.forEach(function(n){if(n.nodeType===1){n.matches&&(n.matches("a")||n.matches("area"))&&b(n);const d=n.querySelectorAll&&n.querySelectorAll("a, area");d&&d.forEach(b)}})})}).observe(document.body,{childList:!0,subtree:!0})}function s(){E(),f(),document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){y()}):y()}window[m]={process:y},s()})(),(function(){const m="data-ln-link",c="lnLink";if(window[c]!==void 0)return;var p=null;function b(){p=document.createElement("div"),p.className="ln-link-status",document.body.appendChild(p)}function y(a){p&&(p.textContent=a,p.classList.add("ln-link-status--visible"))}function E(){p&&p.classList.remove("ln-link-status--visible")}function f(a,l){if(!l.target.closest("a, button, input, select, textarea")){var h=a.querySelector("a");if(h){var v=h.getAttribute("href");if(v){if(l.ctrlKey||l.metaKey){window.open(v,"_blank");return}h.click()}}}}function s(a){var l=a.querySelector("a");if(l){var h=l.getAttribute("href");h&&y(h)}}function r(){E()}function o(a){a._lnLinkInit||(a._lnLinkInit=!0,a.querySelector("a")&&(a.addEventListener("click",function(l){f(a,l)}),a.addEventListener("mouseenter",function(){s(a)}),a.addEventListener("mouseleave",r)))}function e(a){if(!a._lnLinkInit){a._lnLinkInit=!0;var l=a.tagName;if(l==="TABLE"||l==="TBODY"){var h=l==="TABLE"&&a.querySelector("tbody")||a,v=h.querySelectorAll("tr");v.forEach(o)}else o(a)}}function n(a){a.hasAttribute&&a.hasAttribute(m)&&e(a);var l=a.querySelectorAll?a.querySelectorAll("["+m+"]"):[];l.forEach(e)}function d(){var a=new MutationObserver(function(l){l.forEach(function(h){h.type==="childList"&&h.addedNodes.forEach(function(v){if(v.nodeType===1&&(n(v),v.tagName==="TR")){var _=v.closest("["+m+"]");_&&o(v)}})})});a.observe(document.body,{childList:!0,subtree:!0})}function t(a){n(a)}window[c]={init:t};function i(){b(),d(),t(document.body)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",i):i()})(),(function(){const m="[data-ln-progress]",c="lnProgress";if(window[c]!==void 0)return;function p(o){var e=o.getAttribute("data-ln-progress");return e!==null&&e!==""}function b(o){y(o)}function y(o){var e=o.querySelectorAll(m)||[];e.forEach(function(n){p(n)&&!n[c]&&(n[c]=new E(n))}),o.hasAttribute&&o.hasAttribute("data-ln-progress")&&p(o)&&!o[c]&&(o[c]=new E(o))}function E(o){return this.dom=o,r.call(this),s.call(this),this}function f(){var o=new MutationObserver(function(e){e.forEach(function(n){n.type==="childList"&&n.addedNodes.forEach(function(d){d.nodeType===1&&y(d)})})});o.observe(document.body,{childList:!0,subtree:!0})}f();function s(){var o=this,e=new MutationObserver(function(n){n.forEach(function(d){(d.attributeName==="data-ln-progress"||d.attributeName==="data-ln-progress-max")&&r.call(o)})});e.observe(this.dom,{attributes:!0,attributeFilter:["data-ln-progress","data-ln-progress-max"]})}function r(){var o=parseFloat(this.dom.getAttribute("data-ln-progress"))||0,e=parseFloat(this.dom.getAttribute("data-ln-progress-max"))||100,n=e>0?o/e*100:0;n<0&&(n=0),n>100&&(n=100),this.dom.style.width=n+"%"}window[c]=b,document.readyState==="loading"?document.addEventListener("DOMContentLoaded",function(){window.lnProgress(document.body)}):window.lnProgress(document.body)})()})();
