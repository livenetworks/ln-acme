<!DOCTYPE html>
<html lang="mk">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>AJAX — ln-acme</title>
	<link rel="stylesheet" href="../dist/ln-acme.css">
	<link rel="stylesheet" href="demo.css">
	<script src="../js/ln-toast/ln-toast.js" defer></script>
	<script src="../js/ln-toggle/ln-toggle.js" defer></script>
	<script src="../js/ln-nav/ln-nav.js" defer></script>
	<script src="../js/ln-ajax/ln-ajax.js" defer></script>
	<script src="demo.js" defer></script>
</head>
<body>
	<!-- Toast container -->
	<div data-ln-toast></div>

	<div class="app-wrapper">
		<!-- Header -->
		<div class="header">
			<div class="header-left">
				<button class="menu-toggle" data-ln-toggle-for="demo-sidebar">
					<span class="ln-icon-menu"></span>
				</button>
				<h1>AJAX</h1>
			</div>
			<div class="header-right">
				<div class="header-actions">
					<button class="btn btn--secondary" onclick="window.lnToast.enqueue({type:'info', title:'Инфо', message:'AJAX навигација компонента.'})">
						Test Toast
					</button>
				</div>
			</div>
		</div>

		<!-- App Body -->
		<div class="app-body">
		<!-- Sidebar -->
		<aside class="sidebar open" id="demo-sidebar" data-ln-toggle="open">
			<div class="sidebar-header">
				<button class="ln-icon-close" data-ln-toggle-for="demo-sidebar" data-ln-toggle-action="close"></button>
			<img class="logo" src="ln-acme-logo.png" alt="ln-acme">
				<span class="app-name">acme-gui</span>
			</div>

			<div class="sidebar-content">
				<nav class="nav" data-ln-nav="active">
					<ul>
						<li><a href="index.html"><span class="nav-icon ln-icon-home"></span><span class="nav-label">Dashboard</span></a></li>
					</ul>

					<h6 class="nav-section">CSS компоненти</h6>
					<ul>
						<li><a href="typography.html"><span class="nav-label">Typography</span></a></li>
						<li><a href="cards.html"><span class="nav-label">Cards</span></a></li>
						<li><a href="tables.html"><span class="nav-label">Tables</span></a></li>
						<li><a href="forms.html"><span class="nav-label">Forms &amp; Buttons</span></a></li>
						<li><a href="layout.html"><span class="nav-label">Layout &amp; Grid</span></a></li>
						<li><a href="sections.html"><span class="nav-label">Sections</span></a></li>
						<li><a href="icons.html"><span class="nav-label">Icons</span></a></li>
						<li><a href="utilities.html"><span class="nav-label">Utilities</span></a></li>
					</ul>

					<h6 class="nav-section">JS компоненти</h6>
					<ul>
						<li><a href="accordion.html"><span class="nav-label">Accordion</span></a></li>
						<li><a href="ajax.html"><span class="nav-label">AJAX</span></a></li>
						<li><a href="external-links.html"><span class="nav-label">External Links</span></a></li>
						<li><a href="nav.html"><span class="nav-label">Nav</span></a></li>
						<li><a href="progress.html"><span class="nav-label">Progress</span></a></li>
						<li><a href="select.html"><span class="nav-label">Select</span></a></li>
						<li><a href="toggle.html"><span class="nav-label">Toggle</span></a></li>
						<li><a href="modal.html"><span class="nav-label">Modal</span></a></li>
						<li><a href="toast.html"><span class="nav-label">Toast</span></a></li>
						<li><a href="tabs.html"><span class="nav-label">Tabs</span></a></li>
						<li><a href="upload.html"><span class="nav-label">Upload</span></a></li>
					</ul>
				</nav>
			</div>

			<div class="sidebar-footer">
				<small>acme-gui v1.0.0</small>
			</div>
		</aside>

		<!-- Main Panel -->
		<div class="main-panel">

			<!-- Content -->
			<div class="content">
					<h1>AJAX</h1>
					<p>Навигациска компонента — линкови и форми внатре во <strong>data-ln-ajax</strong> контејнер се праќаат асинхроно, без полн reload на страница.</p>

					<!-- Основи -->
					<section class="section-card">
						<header><h3>Основи</h3></header>
						<main>
							<table>
								<thead><tr><th>Атрибут</th><th>На елемент</th><th>Опис</th></tr></thead>
								<tbody>
									<tr><td><code>data-ln-ajax</code></td><td>контејнер, &lt;a&gt;, &lt;form&gt;</td><td>Активира AJAX обработка</td></tr>
									<tr><td><code>data-ln-ajax="false"</code></td><td>&lt;a&gt;, &lt;form&gt;</td><td>Исклучи конкретен елемент од AJAX</td></tr>
								</tbody>
							</table>
						</main>
					</section>

					<!-- Линкови -->
					<section class="section-card">
						<header><h3>AJAX Линкови</h3></header>
						<main>
							<article>
								<h4>Однесување</h4>
								<ul>
									<li>Клик на линк → GET AJAX request на <code>href</code></li>
									<li>Ctrl/Cmd+Click → Отвора во нов tab (нормално)</li>
									<li>Middle click → Отвора во нов tab (нормално)</li>
									<li>Линкови со <code>#</code> → прескокнато</li>
									<li>По успешен одговор → URL се додава во browser history (pushState)</li>
								</ul>
							</article>
							<article>
								<h4>HTML пример</h4>
									<pre><code>&lt;div data-ln-ajax&gt;
    &lt;a href="/users"&gt;Корисници&lt;/a&gt;
    &lt;a href="/settings"&gt;Поставки&lt;/a&gt;
    
    &lt;!-- Исклучи конкретен линк --&gt;
    &lt;a href="/login" data-ln-ajax="false"&gt;Логирај се&lt;/a&gt;
&lt;/div&gt;</code></pre>
							</article>
						</main>
					</section>

					<!-- Форми -->
					<section class="section-card">
						<header><h3>AJAX Форми</h3></header>
						<main>
							<article>
								<h4>Однесување</h4>
								<ul>
									<li>Submit → AJAX request (method и action од формата)</li>
										<li>FormData → автоматски се креира</li>
										<li>Копчињата на формата → disable за време на request</li>
										<li>GET форми → параметри во URL + pushState</li>
										<li>POST/PUT/DELETE → body е FormData</li>
									</ul>
							</article>
							<article>
								<h4>HTML пример</h4>
								<pre><code>&lt;form data-ln-ajax method="POST" action="/api/users"&gt;
    &lt;input type="text" name="name" placeholder="Име"&gt;
    &lt;input type="email" name="email" placeholder="Email"&gt;
    &lt;button type="submit"&gt;Зачувај&lt;/button&gt;
&lt;/form&gt;</code></pre>
							</article>
						</main>
					</section>

					<!-- JSON Response Protocol -->
					<section class="section-card">
						<header><h3>JSON Response Protocol</h3></header>
						<main>
							<p>Серверот враќа JSON со следнава структура:</p>
							<pre><code>{
    "title": "Нова странична наслов",
    "content": {
        "main-content": "&lt;h1&gt;Содржина&lt;/h1&gt;",
        "sidebar-nav": "&lt;ul&gt;&lt;li&gt;...&lt;/li&gt;&lt;/ul&gt;"
    },
    "message": {
        "type": "success|error|warn|info",
        "title": "Наслов",
        "body": "Порака",
        "data": {}
    }
}</code></pre>
							<table>
								<thead><tr><th>Поле</th><th>Опис</th></tr></thead>
								<tbody>
									<tr><td><code>title</code></td><td><code>&lt;title&gt;</code> атрибут на страница</td></tr>
									<tr><td><code>content</code></td><td>Објект: селектор → HTML за замена</td></tr>
									<tr><td><code>message</code></td><td>Порака — достапна во <code>ln-ajax:success</code> event</td></tr>
								</tbody>
							</table>
						</main>
					</section>

					<!-- CSS класи -->
					<section class="section-card">
						<header><h3>CSS класи за loading state</h3></header>
						<main>
							<article>
								<h4>За време на request</h4>
								<p>Елементот добива класа <code>.ln-ajax--loading</code>. Користи ја за визуелна повратна информација.</p>
							</article>
							<article>
								<h4>SCSS пример</h4>
								<pre><code>a.ln-ajax--loading {
    opacity: 0.6;
    pointer-events: none;
}

button.ln-ajax--loading {
    cursor: wait;
}</code></pre>
							</article>
						</main>
					</section>

					<!-- CSRF Token -->
					<section class="section-card">
						<header><h3>CSRF Token</h3></header>
						<main>
							<p>Компонентата автоматски читa CSRF token од <code>&lt;meta name="csrf-token"&gt;</code> и го испраќа во header:</p>
							<pre><code>&lt;head&gt;
    &lt;meta name="csrf-token" content="..."&gt;
&lt;/head&gt;

// ln-ajax го читa и го испраќа како:
// X-CSRF-Token: ...</code></pre>
						</main>
					</section>

					<!-- API -->
					<section class="section-card">
						<header><h3>API</h3></header>
						<main>
							<p>ln-ajax нема јавна API — се активира автоматски преку data attributes.</p>
							<pre><code>// Рачна иницијализација на нов DOM елемент
window.lnAjax(document.getElementById('new-container'));</code></pre>
						</main>
					</section>

					<!-- Events -->
					<section class="section-card">
						<header><h3>Events</h3></header>
						<main>
							<article>
								<h4>Lifecycle настани</h4>
								<table>
									<thead><tr><th>Настан</th><th>Кога</th><th><code>detail</code></th></tr></thead>
									<tbody>
										<tr><td><code>ln-ajax:start</code></td><td>Пред fetch</td><td><code>{ method, url }</code></td></tr>
										<tr><td><code>ln-ajax:success</code></td><td>По успешен одговор</td><td><code>{ method, url, data }</code></td></tr>
										<tr><td><code>ln-ajax:error</code></td><td>По fetch грешка</td><td><code>{ method, url, error }</code></td></tr>
										<tr><td><code>ln-ajax:complete</code></td><td>По завршување (секогаш)</td><td><code>{ method, url }</code></td></tr>
									</tbody>
								</table>
								<p>Настаните се dispatch-уваат на елементот кој го иницирал request-от (<code>&lt;a&gt;</code> или <code>&lt;form&gt;</code>) и bubble-аат нагоре.</p>
							</article>
							<article>
								<h4>Интеграција со ln-toast</h4>
								<p><code>ln-ajax</code> не знае за <code>ln-toast</code>. Пораките од JSON response се достапни во <code>ln-ajax:success</code> — проектот одлучува:</p>
								<pre><code>document.addEventListener('ln-ajax:success', function(e) {
    var message = e.detail.data.message;
    if (message &amp;&amp; window.lnToast) {
        window.lnToast.enqueue({
            type: message.type,
            title: message.title,
            message: message.body
        });
    }
});</code></pre>
							</article>
							<article>
								<h4>Останати примери</h4>
								<pre><code>// Глобален loading индикатор
document.addEventListener('ln-ajax:start', function(e) {
    document.body.classList.add('loading');
});
document.addEventListener('ln-ajax:complete', function(e) {
    document.body.classList.remove('loading');
});

// Обнови компоненти по DOM промена
document.addEventListener('ln-ajax:success', function(e) {
    window.lnSelect &amp;&amp; window.lnSelect.reinit();
});

// Error handler
document.addEventListener('ln-ajax:error', function(e) {
    console.error('AJAX failed:', e.detail.url, e.detail.error);
});</code></pre>
							</article>
						</main>
					</section>
			</div>

			<!-- Footer -->
			<footer class="footer">
				<span>acme-gui &copy; 2026 LiveNetworks</span>
				<span>ln-acme v1.0.0</span>
			</footer>
		</div>
		</div><!-- /.app-body -->
	</div><!-- /.app-wrapper -->
</body>
</html>
